(function(window,document,exportName,undefined){var isMultiTouch=false;var multiTouchStartPos;var eventTarget;var touchElements={};if(!document.createTouch){document.createTouch=function(view,target,identifier,pageX,pageY,screenX,screenY,clientX,clientY){if(clientX==undefined||clientY==undefined){clientX=pageX-window.pageXOffset;clientY=pageY-window.pageYOffset;}return new Touch(target,identifier,{pageX:pageX,pageY:pageY,screenX:screenX,screenY:screenY,clientX:clientX,clientY:clientY});};}if(!document.createTouchList){document.createTouchList=function(){var touchList=new TouchList();for(var i=0;i<arguments.length;i++){touchList[i]=arguments[i];}touchList.length=arguments.length;return touchList;};}function Touch(target,identifier,pos,deltaX,deltaY){deltaX=deltaX||0;deltaY=deltaY||0;this.identifier=identifier;this.target=target;this.clientX=pos.clientX+deltaX;this.clientY=pos.clientY+deltaY;this.screenX=pos.screenX+deltaX;this.screenY=pos.screenY+deltaY;this.pageX=pos.pageX+deltaX;this.pageY=pos.pageY+deltaY;}function TouchList(){var touchList=[];touchList.item=function(index){return this[index]||null;};touchList.identifiedTouch=function(id){return this[id+1]||null;};return touchList;}function fakeTouchSupport(){var objs=[window,document.documentElement];var props=["ontouchstart","ontouchmove","ontouchcancel","ontouchend"];for(var o=0;o<objs.length;o++){for(var p=0;p<props.length;p++){if(objs[o]&&objs[o][props[p]]==undefined){objs[o][props[p]]=null;}}}}function hasTouchSupport(){return("ontouchstart" in window)||(window.Modernizr&&window.Modernizr.touch)||(navigator.msMaxTouchPoints||navigator.maxTouchPoints)>2;}function preventMouseEvents(ev){ev.preventDefault();ev.stopPropagation();}function onMouse(touchType){return function(ev){if(ev.target.tagName&&(ev.target.tagName=="INPUT"||ev.target.tagName=="SELECT"||ev.target.tagName=="TEXTAREA")){return;}preventMouseEvents(ev);if(ev.which!==1){return;}if(ev.type=="mousedown"||!eventTarget||(eventTarget&&!eventTarget.dispatchEvent)){eventTarget=ev.target;}if(isMultiTouch&&!ev.shiftKey){triggerTouch("touchend",ev);isMultiTouch=false;}triggerTouch(touchType,ev);if(!isMultiTouch&&ev.shiftKey){isMultiTouch=true;multiTouchStartPos={pageX:ev.pageX,pageY:ev.pageY,clientX:ev.clientX,clientY:ev.clientY,screenX:ev.screenX,screenY:ev.screenY};triggerTouch("touchstart",ev);}if(ev.type=="mouseup"){multiTouchStartPos=null;isMultiTouch=false;eventTarget=null;}};}function triggerTouch(eventName,mouseEv){var touchEvent=document.createEvent("Event");touchEvent.initEvent(eventName,true,true);touchEvent.altKey=mouseEv.altKey;touchEvent.ctrlKey=mouseEv.ctrlKey;touchEvent.metaKey=mouseEv.metaKey;touchEvent.shiftKey=mouseEv.shiftKey;touchEvent.touches=getActiveTouches(mouseEv,eventName);touchEvent.targetTouches=getActiveTouches(mouseEv,eventName);touchEvent.changedTouches=getChangedTouches(mouseEv,eventName);eventTarget.dispatchEvent(touchEvent);}function createTouchList(mouseEv){var touchList=new TouchList();if(isMultiTouch){var f=TouchEmulator.multiTouchOffset;var deltaX=multiTouchStartPos.pageX-mouseEv.pageX;var deltaY=multiTouchStartPos.pageY-mouseEv.pageY;touchList.push(new Touch(eventTarget,1,multiTouchStartPos,(deltaX*-1)-f,(deltaY*-1)+f));touchList.push(new Touch(eventTarget,2,multiTouchStartPos,deltaX+f,deltaY-f));}else{touchList.push(new Touch(eventTarget,1,mouseEv,0,0));}return touchList;}function getActiveTouches(mouseEv,eventName){if(mouseEv.type=="mouseup"){return new TouchList();}var touchList=createTouchList(mouseEv);if(isMultiTouch&&mouseEv.type!="mouseup"&&eventName=="touchend"){touchList.splice(1,1);}return touchList;}function getChangedTouches(mouseEv,eventName){var touchList=createTouchList(mouseEv);if(isMultiTouch&&mouseEv.type!="mouseup"&&(eventName=="touchstart"||eventName=="touchend")){touchList.splice(0,1);}return touchList;}function showTouches(ev){var touch,i,el,styles;for(i=0;i<ev.touches.length;i++){touch=ev.touches[i];el=touchElements[touch.identifier];if(!el){el=touchElements[touch.identifier]=document.createElement("div");document.body.appendChild(el);}styles=TouchEmulator.template(touch);for(var prop in styles){el.style[prop]=styles[prop];}}if(ev.type=="touchend"||ev.type=="touchcancel"){for(i=0;i<ev.changedTouches.length;i++){touch=ev.changedTouches[i];el=touchElements[touch.identifier];if(el){el.parentNode.removeChild(el);delete touchElements[touch.identifier];}}}}function TouchEmulator(){if(hasTouchSupport()){return;}fakeTouchSupport();window.addEventListener("mousedown",onMouse("touchstart"),true);window.addEventListener("mousemove",onMouse("touchmove"),true);window.addEventListener("mouseup",onMouse("touchend"),true);window.addEventListener("mouseenter",preventMouseEvents,true);window.addEventListener("mouseleave",preventMouseEvents,true);window.addEventListener("mouseout",preventMouseEvents,true);window.addEventListener("mouseover",preventMouseEvents,true);window.addEventListener("touchstart",showTouches,true);window.addEventListener("touchmove",showTouches,true);window.addEventListener("touchend",showTouches,true);window.addEventListener("touchcancel",showTouches,true);}TouchEmulator.multiTouchOffset=75;TouchEmulator.template=function(touch){var size=30;var transform="translate("+(touch.clientX-(size/2))+"px, "+(touch.clientY-(size/2))+"px)";return{position:"fixed",left:0,top:0,background:"#fff",border:"solid 1px #999",opacity:0.6,borderRadius:"100%",height:size+"px",width:size+"px",padding:0,margin:0,display:"block",overflow:"hidden",pointerEvents:"none",webkitUserSelect:"none",mozUserSelect:"none",userSelect:"none",webkitTransform:transform,mozTransform:transform,transform:transform,zIndex:100};};window[exportName]=TouchEmulator;function createProperty(value){var _value=value;function _get(){return _value;}function _set(v){_value=v;}return{get:_get,set:_set};}function makePropertyWritable(objBase,objScopeName,propName,initValue){var newProp,initObj;if(objBase&&objScopeName in objBase&&propName in objBase[objScopeName]){if(typeof initValue==="undefined"){initValue=objBase[objScopeName][propName];}newProp=createProperty(initValue);try{Object.defineProperty(objBase[objScopeName],propName,newProp);}catch(e){initObj={};initObj[propName]=newProp;try{objBase[objScopeName]=Object.create(objBase[objScopeName],initObj);}catch(e){}}}}var localSearch=window.location.search;var oldUseragent;if(localSearch.indexOf("&")!=-1){var reg=/.*\&(.*)/;oldUseragent=localSearch.match(reg)[1];}else{var reg2=/\?(.*)/;oldUseragent=localSearch.match(reg2)[1];}var useragent=oldUseragent.replace(/%20/g," ").replace("e_ua=User-Agent,","");if(useragent){makePropertyWritable(window,"navigator","userAgent");window.navigator.userAgent=useragent;TouchEmulator();}})(window,document,"TouchEmulator");